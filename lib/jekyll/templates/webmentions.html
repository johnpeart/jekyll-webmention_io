{% capture webmention_types %}{{ types | join: ',' }}{% endcapture %}

{%- if html_proofer_ignore == "all" -%}
{%- assign html_proofer_attr = " data-proofer-ignore" -%}
{%- endif -%}

{% if webmentions.size > 0 %}
<aside class="webmentions"{{ html_proofer_attr }}{% unless webmention_types=="" %} data-webmention-types="{{ webmention_types }}"{% endunless %}>
  <hr>
  <h2>Web mentions</h2>
  <ol class="webmentions--list">
    {% for webmention in webmentions %}
        {% if webmention.type == "reply" or webmention.type == "post" %}

            <li id="webmention-{{ webmention.id }}" class="webmentions--item {% if webmention.author.name == 'John Peart' %}from-me{% else %}from-them{% endif %} webmention--{{ webmention.type }}">
                <article class="h-cite webmention webmention--{{ webmention.type }}">
                    {% if webmention.author %}
                    <div class="webmention--author p-author h-card">
                        {% if webmention.pubdate %}On {% if webmention.raw.source %}<a class="webmention__source u-url" href="{{ webmention.raw.source }}" rel="nofollow">{% endif %}<time class="webmention--pubdate dt-published" datetime="{{ webmention.pubdate | date: '%FT%T%:z' }}">{{ webmention.pubdate | date: '%d %B %Y' }}</time>{% if webmention.uri %}</a>{% endif %}, {% endif %}<a class="u-url p-name" href="{{ webmention.author.url }}" rel="nofollow">{{ webmention.author.name }}</strong></a> said
                    </div>
                    {% endif %}
                    <div class="webmention--content p-content">
                    {% if webmention.content %}
                        {{ webmention.content }}
                    {% else %}
                        {{ webmention.title }}
                    {% endif %}
                    </div>
                </article>
            </li>

        {% elsif webmention.type == "repost" or webmention.type == "like" or webmention.type == "bookmark" %}

            {% if webmention.author %}
            <li id="webmention-{{ webmention.id }}" class="webmentions--item webmention--{{ webmention.type }}">
                <article class="h-cite webmention webmention--{{ webmention.type }}">
                    <div class="webmention--content p-content webmention--author p-author h-card">
                        <p><span class="icon {% if webmention.type == "repost" %}share{% elsif webmention.type == "like" %}heart{% elsif webmention.type == "bookmark" -%}bookmark{% endif %}"></span><a class="u-url p-name" href="{{ webmention.author.url }}" rel="nofollow">{{ webmention.author.name }}</a> {% if webmention.type == "repost" %}shared{% elsif webmention.type == "like" %}liked{% elsif webmention.type == "bookmark" -%}bookmarked{% endif %} this post{% if webmention.pubdate %} on {% if webmention.raw.source %}<a class="webmention__source u-url" href="{{ webmention.raw.source }}" rel="nofollow">{% endif %}<time class="webmention--pubdate dt-published" datetime="{{ webmention.pubdate | date: '%FT%T%:z' }}">{{ webmention.pubdate | date: '%d %B %Y' }}</time>{% if webmention.uri %}</a>{% endif %}{% endif %}</p>
                    </div>
                </article>
            </li>
            {% endif %}

        {% endif %}
    {% endfor %}
  </ol>
</aside>
{% endif %}
